<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .group {
      display: flex;
      line-height: 28px;
      align-items: center;
      position: relative;
      max-width: 990px;
    }

    .input {
      width: 100%;
      height: 40px;
      line-height: 28px;
      padding: 0 1rem;
      padding-left: 2.5rem;
      border: 2px solid transparent;
      border-radius: 8px;
      outline: none;
      background-color: #ffff;
      color: #0d0c22;
      transition: .2s ease;
    }

    .input::placeholder {
      color: #9e9ea7;
    }
    

   .input:focus, input:hover {
      outline: none;
      border-color:rgba(186, 180, 214, 0.4);
      background-color: #fff;
      box-shadow: 0 0 0 1px rgba(83, 49, 128, 0.1);
    } 

    .icon {
      position: absolute;
      left: 1rem;
      fill: #9e9ea7;
      width: 1rem;
      height: 1rem;
    }

    /* Filter Button Styling */
    .filterbtn {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: transparent;
      border: none;
      cursor: pointer;
      padding: 0 10px;
    }

    .filterbtn img {
      width: 1.2em;
      height: 1.2em;
      color: #6b7280; /* Slightly muted gray */
    }

    .filterbtn:hover img {
      filter: brightness(0.8); /* Darker effect on hover */
    }
    .dropdown-menu {
      display: none;
      position: absolute;
      top: 100%;
      right: 0;
      background-color: white;
      border: 1px solid #e5e7eb;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      border-radius: 5px;
      overflow: hidden;
      z-index: 10;
      padding: 5px;
    }

    .dropdown-menu.active {
      display: block;
    }

    .dropdown-item {
      padding: 0.25rem 1.5rem;
      cursor: pointer;
      color: #374151;
      transition: background-color 0.2s ease;
      font-size: medium;
      display:100%;
      
    }
    #dd1
    {
      
      font-weight:500;
      color:rgb(228, 17, 17);
    }
    #dd2
    {
      font-weight:500;
      color:rgb(15, 102, 69);
    }
    #dd3
    {
      font-weight:500;
      color:rgb(10, 10, 66);
    }
    .dropdown-item:hover {
      background-color: #f3f4f6;
    }
   .overflow-x-auto  
   {
    padding-top:60px;
   }
  </style>
</head>
<body class="bg-gray-100">
  <div class="flex h-screen">
    <!-- Sidebar -->
    <aside class="w-64 bg-gray-800 text-white shadow-md p-5">
      <h2 class="text-2xl font-bold mb-6">Admin Dashboard</h2>
      <nav>
        <ul>
          <li class="py-2 px-4 hover:bg-gray-700 rounded cursor-pointer" onclick="showSection('dashboard')">Dashboard Overview</li>
          <li class="py-2 px-4 hover:bg-gray-700 rounded cursor-pointer" onclick="showSection('centres')">Akshaya Centres List</li>
          <li class="py-2 px-4 hover:bg-red-700 rounded cursor-pointer" onclick="logout()">Logout</li>
        </ul>
      </nav>
    </aside>
    
    <!-- Main Content -->
    <main class="flex-1 p-6">
      <!-- Dashboard Overview Section -->
      <section id="dashboard-section">
        <!-- Header -->
        <div class="flex justify-between items-center bg-gray-200 shadow p-4 rounded-md mb-6">
          <h2 class="text-xl font-semibold">Dashboard Overview</h2>
          <span class="text-gray-700 font-medium">Admin</span>
        </div>
        <!-- Summary Cards -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
          <div class="bg-white p-4 rounded shadow">
            <p class="text-sm text-gray-500">Total Centres</p>
            <p class="text-2xl font-bold text-gray-800"><%= counts.total %></p>
          </div>
          <div class="bg-white p-4 rounded shadow">
            <p class="text-sm text-gray-500">Approved Centres</p>
            <p class="text-2xl font-bold text-green-600"><%= counts.approved %></p>
          </div>
          <div class="bg-white p-4 rounded shadow">
            <p class="text-sm text-gray-500">Pending Approval</p>
            <p class="text-2xl font-bold text-yellow-600"><%= counts.pending %></p>
          </div>
          <div class="bg-white p-4 rounded shadow">
            <p class="text-sm text-gray-500">Rejected Centres</p>
            <p class="text-2xl font-bold text-red-600"><%= counts.rejected %></p>
          </div>
        </div>
      </section>
      
      <!-- Centres List Section -->
      <section id="centres-section" class="hidden">
        <h3 class="text-lg font-semibold mb-4">Akshaya Centres List</h3>
        <div class="group">
          <svg class="icon" aria-hidden="true" viewBox="0 0 24 24">
            <g>
              <path d="M21.53 20.47l-3.66-3.66C19.195 15.24 20 13.214 20 11c0-4.97-4.03-9-9-9s-9 4.03-9 9 4.03 9 9 9c2.215 0 4.24-.804 5.808-2.13l3.66 3.66c.147.146.34.22.53.22s.385-.073.53-.22c.295-.293.295-.767.002-1.06zM3.5 11c0-4.135 3.365-7.5 7.5-7.5s7.5 3.365 7.5 7.5-3.365 7.5-7.5 7.5-7.5-3.365-7.5-7.5z"></path>
            </g>
          </svg>
          <input placeholder="Search" type="search" class="input">
          <button class="filterbtn" id="dropdownButton">
            <img src="../uploads/images/filter.svg" alt="" class="w-6 h-6 rounded-full">
          
          <div id="dropdownMenu" class="dropdown-menu">
            <div class="dropdown-item" id="dd1" onclick="filterTable('pending')">Pending</div>
            <div class="dropdown-item"id="dd2" onclick="filterTable('approved')">Approved</div>
            <div class="dropdown-item" id="dd3" onclick="filterTable('rejected')">Rejected</div>
          </button> 
        </div>

        <!-- Centres Table -->
        <div class="overflow-x-auto">
          <table class="w-full border-collapse border border-gray-200">
            <thead>
              <tr class="bg-gray-100">
                <th class="border border-gray-300 p-2">Centre Name</th>
                <th class="border border-gray-300 p-2">Owner Name</th>
                <th class="border border-gray-300 p-2">Contact</th>
                <th class="border border-gray-300 p-2">Status</th>
                <th class="border border-gray-300 p-2">Actions</th>
              </tr>
            </thead>
            <tbody id="centres-table-body">
              <% if (centres.length === 0) { %>
                <tr>
                  <td colspan="5" class="border border-gray-300 p-2 text-center">No centres available.</td>
                </tr>
              <% } else { %>
                <% centres.forEach(function(centre) { %>
                  <tr class="centre-row" data-status="<%= centre.status %>">
                    <td class="border border-gray-300 p-2 text-center"><%= centre.centreName %></td>
                    <td class="border border-gray-300 p-2 text-center"><%= centre.ownerName %></td>
                    <td class="border border-gray-300 p-2 text-center"><%= centre.contact %></td>
                    <td class="border border-gray-300 p-2 text-center capitalize"><%= centre.status %></td>
                    <td class="border border-gray-300 p-2 text-center">
                      <% if (centre.status === 'pending') { %>
                        <a href="/approve-centre/<%= centre._id %>" class="text-green-500 hover:text-green-700">
                          <svg class="w-5 h-5 inline" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path>
                          </svg>
                        </a>
                        <a href="/reject-centre/<%= centre._id %>" class="text-red-500 hover:text-red-700 ml-4">
                          <svg class="w-5 h-5 inline" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path>
                          </svg>
                        </a>
                      <% } else { %>
                        <span class="text-gray-500">No Actions</span>
                      <% } %>
                    </td>
                  </tr>
                <% }); %>
              <% } %>
            </tbody>
          </table>
        </div>
      </section>
    </main>
  </div>
  
  <script>
    // Switch between Dashboard Overview and Centres List sections
    function showSection(section) {
      if (section === 'dashboard') {
        document.getElementById('dashboard-section').classList.remove('hidden');
        document.getElementById('centres-section').classList.add('hidden');
      } else if (section === 'centres') {
        document.getElementById('dashboard-section').classList.add('hidden');
        document.getElementById('centres-section').classList.remove('hidden');
      }
    }
    
    // Filter centres table based on status
    function filterTable(status) {
      const rows = document.querySelectorAll('.centre-row');
      rows.forEach(row => {
        if (status === 'all') {
          row.style.display = '';
        } else {
          if (row.getAttribute('data-status') === status) {
            row.style.display = '';
          } else {
            row.style.display = 'none';
          }
        }
      });
    }
    
    // JavaScript to toggle the dropdown menu
    const dropdownButton = document.getElementById('dropdownButton');
    const dropdownMenu = document.getElementById('dropdownMenu');

    // Toggle active class on dropdown menu
    dropdownButton.addEventListener('click', () => {
      dropdownMenu.classList.toggle('active');
      
    });

    // Close dropdown when clicking outside
    document.addEventListener('click', (event) => {
      if (!dropdownButton.contains(event.target) && !dropdownMenu.contains(event.target)) {
        dropdownMenu.classList.remove('active');
      }
    });// Toggle Dropdown Menu

   // Search functionality for Centre Name/Number
const searchInput = document.querySelector('.input'); // Select the search input field
const tableRows = document.querySelectorAll('.centre-row'); // Select all rows in the table

searchInput.addEventListener('input', () => {
  const searchTerm = searchInput.value.toLowerCase().trim(); // Get the search term and normalize it
  tableRows.forEach(row => {
    const centreNameCell = row.querySelector('td:first-child'); // First column contains Centre Name/Number
    if (centreNameCell) {
      const centreName = centreNameCell.textContent.toLowerCase(); // Normalize the Centre Name/Number
      if (centreName.includes(searchTerm)) {
        row.style.display = ''; // Show matching rows
      } else {
        row.style.display = 'none'; // Hide non-matching rows
      }
    }
  });
});
    // Example logout function (adjust as needed)
    function logout() {
      // For example, clear session data or call a logout API endpoint before redirecting:
      window.location.href = '/logout';
    }
  </script>
</body>
</html>